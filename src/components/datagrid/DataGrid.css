/* Layout */
.dg-wrapper {
    background: var(--bs-body-bg);
    border-radius: .5rem;
    box-shadow: 0 .125rem .25rem rgba(0,0,0,.075);
    overflow: hidden;
}

/* Tabela */
.dg-table {
    --dg-header-bg: #fff;
    --dg-filter-bg: #fafafa;
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

.dg-table thead th {
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--dg-header-bg);
    border-bottom: 1px solid var(--bs-border-color);
    vertical-align: middle;
    white-space: nowrap;
    user-select: none;
    overflow: visible; /* potrzebne dla popoverów */
}

.dg-table thead { position: relative; z-index: 3; }

.dg-filter-row th {
    position: sticky;
    top: 42px; /* wysokość headera */
    z-index: 1;
    background: var(--dg-filter-bg);
    border-bottom: 1px solid var(--bs-border-color);
    padding: .35rem .5rem;
}

.dg-filter-input {
    width: 100%;
}

.dg-sort-icon {
    margin-left: .25rem;
    opacity: .5;
}

/* Komórka nagłówka (połączone definicje) */
.dg-header-cell {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .35rem;
    padding: .5rem .75rem;
    font-weight: 600;
}

/* Resizer */
.dg-resizer {
    position: absolute;
    top: 0;
    right: 0;
    width: 8px;
    height: 100%;
    cursor: col-resize;
    user-select: none;
}
.dg-resizer:hover::after,
.dg-resizing .dg-resizer::after {
    content: "";
    position: absolute;
    top: 0; bottom: 0; right: 3px;
    width: 2px;
    background: var(--bs-primary);
}
.dg-resizing { cursor: col-resize; }

/* Drag & drop kolumn */
.dg-header-dragging { opacity: .6; }
.dg-header-drop-target { box-shadow: inset 0 -3px 0 var(--bs-primary); }

/* Body */
.dg-table tbody td {
    background: #fff;
    border-top: 1px solid var(--bs-border-color);
    vertical-align: middle;
    padding: .5rem .75rem;
}

/* Toolbar / footer */
.dg-toolbar {
    padding: .5rem .75rem;
    background: #fff;
    border-bottom: 1px solid var(--bs-border-color);
}
.dg-footer {
    padding: .5rem .75rem;
    background: #fff;
    border-top: 1px solid var(--bs-border-color);
}

/* Pusty stan */
.dg-empty {
    text-align: center;
    color: var(--bs-secondary-color);
    padding: 2rem;
}

/* Overlay ładowania */
.dg-loading-overlay {
    position: absolute;
    inset: 0;
    background: rgba(255,255,255,.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
}

/* Przycisk filtra przy kolumnie */
.dg-filter-btn {
    border: none;
    background: transparent;
    padding: 0 .25rem;
    color: var(--bs-secondary-color);
}
.dg-filter-btn:hover { color: var(--bs-body-color); }
.dg-filter-active { color: var(--bs-primary) !important; }

/* Popup filtra (card-like) – gdy montowany w th (fallback) */
.dg-filter-popover {
    position: absolute;
    top: calc(100% + 6px);
    right: 0;
    z-index: 20;
    width: 280px;
    max-height: 420px;
    background: #fff;
    border: 1px solid var(--bs-border-color);
    border-radius: .5rem;
    box-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
    display: flex;
    flex-direction: column;
}

.dg-filter-popover .dg-values {
    max-height: 180px;
    overflow: auto;
    padding: .5rem .75rem;
    border-bottom: 1px solid var(--bs-border-color);
}

.dg-filter-popover .dg-conds { padding: .5rem .75rem; }

.dg-filter-popover .dg-actions {
    padding: .5rem .75rem;
    border-top: 1px solid var(--bs-border-color);
    display: flex;
    gap: .5rem;
    justify-content: flex-end;
}

/* Popover montowany w body (portal) */
.dg-filter-popover--portal {
    position: fixed;      /* render w <body> */
    z-index: 1080;        /* ponad sticky header i dropdowny */
    width: 280px;
    max-height: 420px;
    background: #fff;
    border: 1px solid var(--bs-border-color);
    border-radius: .5rem;
    box-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
    display: flex;
    flex-direction: column;
}
.dg-filter-popover--portal .dg-values { max-height: 180px; }

@media (max-width: 480px) {
    .dg-filter-popover--portal { width: 90vw; }
}

/* Layout wiersza z warunkami (select + inputy) */
.dg-cond-row{
    display:flex;
    align-items:center;
    gap:.5rem;
}

.dg-op-select{
    flex:0 0 150px; /* stała szerokość selektora operatora */
}

.dg-range{
    display:flex;
    align-items:center;
    gap:.5rem;
    flex:1 1 auto;
    min-width:0; /* zapobiega overflow */
}
.dg-range .form-control{
    min-width:0; /* pozwala wejściom się zwężać */
}

/* wiersz warunków: 2 kolumny (operator | pole/pola) */
.dg-cond-row{
    display:grid;
    grid-template-columns: 150px minmax(0,1fr);
    align-items:center;
    gap:.5rem;
}

/* kontener zakresu: input — "i" — input */
.dg-range{
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    align-items:center;
    gap:.5rem;
    min-width:0;
}

/* KLUCZOWE: zmuszamy inputy (w tym date) do kurczenia się */
.dg-range .form-control,
.dg-cond-row .form-control{
    min-width:0;
    width: 100%;
    flex: 1 1 0;
}

/* Safari/Chrome potrafią narzucać min-width dla date — nadpisz */
.dg-filter-popover input[type="date"]{
    min-width:0 !important;
    width:100% !important;
}

/* trochę więcej miejsca, gdy popup jest w trybie zakresu */
.dg-filter-popover--portal.dg-wide{
    width: 420px;            /* możesz zmienić na 460px */
    max-width: min(90vw, 460px);
}
